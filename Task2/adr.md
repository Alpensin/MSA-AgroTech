### <a name="_b7urdng99y53"></a>**Название задачи:** 
Платформа для мониторинга скота
### <a name="_hjk0fkfyohdk"></a>**Автор:**
МА
### <a name="_uanumrh8zrui"></a>**Дата:**
27.10.2025
### <a name="_3bfxc9a45514"></a>**Функциональные требования**


|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
|1|Управление Edge-устройствами, Edge-устройство (кормушка), Сбор метрик|Кормление животных|По расписанию осуществляется подача и перекрытие подачи корма. Фиксируются остатки|
|2|Видеорегистратор, Edge-устройство (видеокамера), Анализ данных видеомониторинга, сбор метрик, отправка уведомлений, Оператор|Фиксация необычного поведения животных|ИИ фиксирует необычное поведение животных, фиксирует в метриках и отправляет уведомление|
|3|Управление Edge-устройствами, Edge-устройство (кормушка), Сбор метрик, уведомления, Оператор|Фиксация поломки, загрязнения фильтров, опустошения кормушки и т.д.|Система контроля edge-устройствами фиксирует неполадку, фиксирует в метриках и отправляет уведомление|
|4|Управление Edge-устройствами, Edge-устройство (датчик на скоте, видеокамера), Анализ данных с видеомониторинга, Сбор метрик|Пересчет скота|Система контроля edge-устройствами записывает количество скота по датчика и/или Анализ данных с видеомониторинга проводит расчет с помощью ИИ. Фиксируется в метриках|
|5|Расписание, Управление Edge-устройствами, Анализ данных с видеомониторинга, Оператор, Дежурная Смена|Переконфигурация|Задается новое расписание работы, меняется конфигурация систем управления|
### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**
|**№**|**Требование**|
| :-: | :- |
|1|Задержка до 10 минут без учета проблем со связью|
|2|Резерв связи для отправки уведомлений оператору|
|3|Возможность интегрировать заказчикам при реализации как SAAS|
|4|Работа автономно при потере связи с Центральным Узлом|
|5|Иметь API для мобильного приложения и веб-приложения|
|6|Позволять системе видеоаналитики реагировать в реальном времени (миллисекунды)|
|7|Иметь высокую производительность — от момента возникновения нештатной ситуации, зафиксированной с помощью видеоаналитики, должно проходить не более 5 секунд до момента оповещения|
|8|Отказоустойчивость 99,95%|
|9|Быть расширяемой, то есть иметь возможность разработать новый функционал без изменений существующего|
### <a name="_qmphm5d6rvi3"></a>**Решение**
#### Основное решение:
[main](./main-container.puml)

В качестве брокера на ферме был выбран RabbitMQ. Это связано с простотой развертывания, ограниченного трафика на ферме и более удобного интерфейса управления и сложной логики распределения событий. Это позволит быстрее стартовать проект и внедрять новый функционал с использованием системы управления и правил маршрутизации событий от RabbitMQ.

Для Центрального узла выбрана Kafka, т.к. она выдерживает большую нагрузку, за счет чего сможет выдержать трафик со множества ферм и в случае необходимости легко масштабироваться за счет горизонтального увеличения кластера.
Также будет просто настроить нужную глубину хранения данных.

В качестве языков программирования были выбраны Go, Python и C/C++ для обработки видео. C/С++ в качестве библиотек для Python.
Выбор Python обусловлен развитой экосистемой для работы с ИИ и распространенностью разработчиков. Для потенциально загруженных сервисов выбран ЯП Go, обладающий хорошим соотношением популярность, скорость разработки и производительность.

В качестве СУБД выбран Postgres. На ферме нет жестких требований к БД. По этой причине важным фактором является популярность решения, т.к. позволит разработчикам быстро внедрить свои решения с данной БД.

### <a name="_bjrr7veeh80c"></a>**Альтернативы**
[alternative](./alternative-container.puml)
В альтернативном решении на данном уровне нет отличий.

**Недостатки, ограничения, риски**

1. Большое количество оборудования расположено на самих фермах
2. Возможны перебои со связью между фермой и Центральным Узлом
3. Возможна потеря связи у Оператора. Это может привести к задержкам в уведомлениях.
4. На каждой ферме требуется высокопроизводительный сервер с GPU для размещения ИИ модели.